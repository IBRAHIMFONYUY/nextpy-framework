{% extends "_base.html" %}

{% block content %}
<!-- Header -->
<div class="bg-gradient-to-br from-blue-50 to-indigo-50 py-16 px-4 mb-12">
    <div class="max-w-6xl mx-auto">
        <h1 class="text-5xl font-bold text-gray-900 mb-4">Complete Documentation</h1>
        <p class="text-xl text-gray-600">Learn everything about NextPy with detailed guides and examples</p>
    </div>
</div>

<div class="max-w-7xl mx-auto px-4 pb-16">
    <div class="grid lg:grid-cols-4 gap-12">
        <!-- Sidebar Navigation -->
        <aside class="lg:col-span-1">
            <nav class="sticky top-20 space-y-8 text-sm">
                <div>
                    <h3 class="font-bold text-gray-900 mb-4 flex items-center gap-2">
                        <span class="text-lg">üöÄ</span> Getting Started
                    </h3>
                    <ul class="space-y-3 text-gray-600">
                        <li><a href="#installation" class="hover:text-blue-600 hover:underline">Installation</a></li>
                        <li><a href="#quickstart" class="hover:text-blue-600 hover:underline">Quick Start</a></li>
                        <li><a href="#project-structure" class="hover:text-blue-600 hover:underline">Project Structure</a></li>
                        <li><a href="#cli-commands" class="hover:text-blue-600 hover:underline">CLI Commands</a></li>
                    </ul>
                </div>

                <div>
                    <h3 class="font-bold text-gray-900 mb-4 flex items-center gap-2">
                        <span class="text-lg">üìÑ</span> Core Concepts
                    </h3>
                    <ul class="space-y-3 text-gray-600">
                        <li><a href="#file-based-routing" class="hover:text-blue-600 hover:underline">File-based Routing</a></li>
                        <li><a href="#pages-rendering" class="hover:text-blue-600 hover:underline">Pages & Rendering</a></li>
                        <li><a href="#data-fetching" class="hover:text-blue-600 hover:underline">Data Fetching (SSR/SSG)</a></li>
                        <li><a href="#api-routes" class="hover:text-blue-600 hover:underline">API Routes</a></li>
                    </ul>
                </div>

                <div>
                    <h3 class="font-bold text-gray-900 mb-4 flex items-center gap-2">
                        <span class="text-lg">üîß</span> Advanced
                    </h3>
                    <ul class="space-y-3 text-gray-600">
                        <li><a href="#database" class="hover:text-blue-600 hover:underline">Database Integration</a></li>
                        <li><a href="#authentication" class="hover:text-blue-600 hover:underline">Authentication</a></li>
                        <li><a href="#components" class="hover:text-blue-600 hover:underline">Components & Templates</a></li>
                        <li><a href="#utilities" class="hover:text-blue-600 hover:underline">Built-in Utilities</a></li>
                    </ul>
                </div>

                <div>
                    <h3 class="font-bold text-gray-900 mb-4 flex items-center gap-2">
                        <span class="text-lg">üìö</span> Resources
                    </h3>
                    <ul class="space-y-3 text-gray-600">
                        <li><a href="#deployment" class="hover:text-blue-600 hover:underline">Deployment</a></li>
                        <li><a href="#troubleshooting" class="hover:text-blue-600 hover:underline">Troubleshooting</a></li>
                        <li><a href="#best-practices" class="hover:text-blue-600 hover:underline">Best Practices</a></li>
                    </ul>
                </div>

                <div class="bg-blue-50 rounded-lg p-4">
                    <p class="text-sm text-gray-700"><strong>üìñ Full Reference:</strong> <a href="/documentation" class="text-blue-600 hover:underline">See DOCUMENTATION.md</a></p>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <div class="lg:col-span-3 space-y-16">
            <!-- Installation -->
            <section id="installation">
                <h2 class="text-3xl font-bold mb-6 text-gray-900 pb-4 border-b-2 border-blue-200">Installation</h2>
                <p class="text-gray-700 mb-6">Get NextPy running in seconds:</p>
                
                <div class="bg-gradient-to-br from-gray-900 to-gray-800 rounded-xl p-6 text-gray-100 font-mono text-sm mb-6 overflow-x-auto">
                    <code class="text-green-400">$ pip install nextpy-framework</code>
                </div>

                <p class="text-gray-700 mb-4">Or create a new project:</p>
                <div class="bg-gradient-to-br from-gray-900 to-gray-800 rounded-xl p-6 text-gray-100 font-mono text-sm overflow-x-auto">
                    <code class="text-green-400">$ nextpy create my-awesome-app<br/>$ cd my-awesome-app<br/>$ nextpy dev</code>
                </div>

                <p class="text-gray-600 mt-6 p-4 bg-green-50 rounded-lg border-l-4 border-green-600">
                    ‚ú® Your app is now running at <code class="bg-green-100 px-2 py-1 rounded">http://localhost:5000</code>
                </p>
            </section>

            <!-- Quick Start -->
            <section id="quickstart">
                <h2 class="text-3xl font-bold mb-6 text-gray-900 pb-4 border-b-2 border-blue-200">Quick Start</h2>
                
                <div class="bg-gray-50 rounded-xl p-6 mb-6">
                    <h3 class="text-xl font-bold text-gray-900 mb-3">1. Create Your First Page</h3>
                    <p class="text-gray-700 mb-4">Create <code class="bg-gray-200 px-2 py-1 rounded text-sm">pages/hello.py</code>:</p>
                    <pre class="bg-gray-900 text-green-400 p-4 rounded-lg overflow-x-auto text-sm"><code>def get_template():
    return "hello.html"

async def get_server_side_props(context):
    return {
        "props": {
            "message": "Hello, NextPy!"
        }
    }</code></pre>
                </div>

                <div class="bg-gray-50 rounded-xl p-6 mb-6">
                    <h3 class="text-xl font-bold text-gray-900 mb-3">2. Create Template</h3>
                    <p class="text-gray-700 mb-4">Create <code class="bg-gray-200 px-2 py-1 rounded text-sm">templates/hello.html</code>:</p>
                    <pre class="bg-gray-900 text-green-400 p-4 rounded-lg overflow-x-auto text-sm"><code>{% raw %}{% extends "_base.html" %}
{% block content %}
<h1>{{ message }}</h1>
{% endblock %}{% endraw %}</code></pre>
                </div>

                <div class="bg-blue-50 rounded-xl p-6 border-l-4 border-blue-600">
                    <h3 class="text-xl font-bold text-gray-900 mb-3">‚úÖ Done!</h3>
                    <p class="text-gray-700">Visit <code class="bg-blue-100 px-2 py-1 rounded">http://localhost:5000/hello</code> - changes auto-reload!</p>
                </div>
            </section>

            <!-- Project Structure -->
            <section id="project-structure">
                <h2 class="text-3xl font-bold mb-6 text-gray-900 pb-4 border-b-2 border-blue-200">Project Structure</h2>
                
                <pre class="bg-gray-900 text-green-400 p-6 rounded-xl overflow-x-auto text-sm"><code>my-app/
‚îú‚îÄ‚îÄ pages/                    # File-based routes
‚îÇ   ‚îú‚îÄ‚îÄ index.py             # Homepage (/)
‚îÇ   ‚îú‚îÄ‚îÄ about.py             # About page (/about)
‚îÇ   ‚îú‚îÄ‚îÄ blog/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.py        # Blog listing (/blog)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ [slug].py       # Dynamic posts (/blog/:slug)
‚îÇ   ‚îî‚îÄ‚îÄ api/
‚îÇ       ‚îú‚îÄ‚îÄ posts.py        # GET /api/posts
‚îÇ       ‚îî‚îÄ‚îÄ users/[id].py   # GET /api/users/123
‚îú‚îÄ‚îÄ templates/              # Jinja2 templates
‚îÇ   ‚îú‚îÄ‚îÄ _base.html         # Root layout
‚îÇ   ‚îú‚îÄ‚îÄ index.html         # Home template
‚îÇ   ‚îî‚îÄ‚îÄ components/        # Reusable components
‚îú‚îÄ‚îÄ models/                 # Database models
‚îú‚îÄ‚îÄ main.py                # Application entry
‚îú‚îÄ‚îÄ nextpy.config.py       # Configuration
‚îî‚îÄ‚îÄ .env                   # Secrets</code></pre>
            </section>

            <!-- CLI Commands -->
            <section id="cli-commands">
                <h2 class="text-3xl font-bold mb-6 text-gray-900 pb-4 border-b-2 border-blue-200">CLI Commands</h2>
                
                <div class="space-y-4">
                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                        <p class="font-mono text-sm text-gray-900 mb-2"><strong>$ nextpy create my-app</strong></p>
                        <p class="text-sm text-gray-600">Create new NextPy project</p>
                    </div>
                    
                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                        <p class="font-mono text-sm text-gray-900 mb-2"><strong>$ nextpy dev</strong></p>
                        <p class="text-sm text-gray-600">Start development server with hot reload</p>
                    </div>
                    
                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                        <p class="font-mono text-sm text-gray-900 mb-2"><strong>$ nextpy build</strong></p>
                        <p class="text-sm text-gray-600">Build static site to out/ directory</p>
                    </div>
                    
                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                        <p class="font-mono text-sm text-gray-900 mb-2"><strong>$ nextpy start</strong></p>
                        <p class="text-sm text-gray-600">Start production server</p>
                    </div>
                </div>
            </section>

            <!-- File-based Routing -->
            <section id="file-based-routing">
                <h2 class="text-3xl font-bold mb-6 text-gray-900 pb-4 border-b-2 border-blue-200">File-based Routing</h2>
                <p class="text-gray-700 mb-6">Files in pages/ automatically become routes:</p>

                <div class="overflow-x-auto mb-6">
                    <table class="w-full bg-white rounded-xl shadow-sm">
                        <thead class="bg-gray-100 border-b-2 border-gray-200">
                            <tr>
                                <th class="text-left px-6 py-4 font-bold">File</th>
                                <th class="text-left px-6 py-4 font-bold">Route</th>
                                <th class="text-left px-6 py-4 font-bold">Example</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b hover:bg-gray-50">
                                <td class="px-6 py-4 font-mono text-sm">pages/index.py</td>
                                <td class="px-6 py-4 text-blue-600">/</td>
                                <td class="px-6 py-4 text-sm">Home page</td>
                            </tr>
                            <tr class="border-b hover:bg-gray-50">
                                <td class="px-6 py-4 font-mono text-sm">pages/about.py</td>
                                <td class="px-6 py-4 text-blue-600">/about</td>
                                <td class="px-6 py-4 text-sm">About page</td>
                            </tr>
                            <tr class="border-b hover:bg-gray-50">
                                <td class="px-6 py-4 font-mono text-sm">pages/blog/[slug].py</td>
                                <td class="px-6 py-4 text-blue-600">/blog/:slug</td>
                                <td class="px-6 py-4 text-sm">Dynamic posts</td>
                            </tr>
                            <tr class="border-b hover:bg-gray-50">
                                <td class="px-6 py-4 font-mono text-sm">pages/api/posts.py</td>
                                <td class="px-6 py-4 text-blue-600">/api/posts</td>
                                <td class="px-6 py-4 text-sm">API endpoint</td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-6 py-4 font-mono text-sm">pages/docs/[...path].py</td>
                                <td class="px-6 py-4 text-blue-600">/docs/*</td>
                                <td class="px-6 py-4 text-sm">Catch-all route</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="bg-blue-50 rounded-lg p-4 border-l-4 border-blue-600">
                    <p class="text-sm text-gray-700"><strong>üí° Tip:</strong> Files starting with _ (underscore) are not routes - they're templates like _base.html</p>
                </div>
            </section>

            <!-- Data Fetching -->
            <section id="data-fetching">
                <h2 class="text-3xl font-bold mb-6 text-gray-900 pb-4 border-b-2 border-blue-200">Data Fetching (SSR/SSG)</h2>
                
                <div class="bg-gray-50 rounded-xl p-6 mb-6">
                    <h3 class="text-xl font-bold text-gray-900 mb-3">Server-Side Rendering (SSR)</h3>
                    <p class="text-gray-700 mb-4">Fetch data <strong>per request</strong>:</p>
                    <pre class="bg-gray-900 text-green-400 p-4 rounded-lg overflow-x-auto text-sm"><code>async def get_server_side_props(context):
    data = await fetch_from_database()
    return {
        "props": {"data": data},
        "revalidate": 60  # Cache 60 seconds
    }</code></pre>
                </div>

                <div class="bg-gray-50 rounded-xl p-6">
                    <h3 class="text-xl font-bold text-gray-900 mb-3">Static Generation (SSG)</h3>
                    <p class="text-gray-700 mb-4">Fetch data <strong>at build time</strong>:</p>
                    <pre class="bg-gray-900 text-green-400 p-4 rounded-lg overflow-x-auto text-sm"><code>async def get_static_props():
    posts = await get_all_posts()
    return {
        "props": {"posts": posts},
        "revalidate": 3600  # Regenerate hourly
    }

async def get_static_paths():
    posts = await get_all_posts()
    return ["/blog/" + p.slug for p in posts]</code></pre>
                </div>
            </section>

            <!-- API Routes -->
            <section id="api-routes">
                <h2 class="text-3xl font-bold mb-6 text-gray-900 pb-4 border-b-2 border-blue-200">API Routes</h2>
                
                <p class="text-gray-700 mb-6">Create REST APIs with simple Python functions:</p>

                <div class="bg-gray-50 rounded-xl p-6 mb-6">
                    <h3 class="text-xl font-bold text-gray-900 mb-3">Basic GET</h3>
                    <pre class="bg-gray-900 text-green-400 p-4 rounded-lg overflow-x-auto text-sm"><code>async def get(request):
    posts = await fetch_posts()
    return {"posts": posts}</code></pre>
                </div>

                <div class="bg-gray-50 rounded-xl p-6">
                    <h3 class="text-xl font-bold text-gray-900 mb-3">POST with Validation</h3>
                    <pre class="bg-gray-900 text-green-400 p-4 rounded-lg overflow-x-auto text-sm"><code>from pydantic import BaseModel

class CreatePost(BaseModel):
    title: str
    content: str

async def post(request):
    body = await request.json()
    post = CreatePost(**body)
    new_post = await save_post(post)
    return {"id": new_post.id}, 201</code></pre>
                </div>
            </section>

            <!-- Database -->
            <section id="database">
                <h2 class="text-3xl font-bold mb-6 text-gray-900 pb-4 border-b-2 border-blue-200">Database Integration</h2>
                
                <p class="text-gray-700 mb-6">NextPy uses SQLAlchemy ORM with support for SQLite, PostgreSQL, and MySQL.</p>

                <div class="bg-gray-50 rounded-xl p-6 mb-6">
                    <h3 class="font-bold mb-3">Define a Model</h3>
                    <pre class="bg-gray-900 text-green-400 p-4 rounded-lg overflow-x-auto text-sm"><code>from nextpy.db import Base
from sqlalchemy import Column, String, Integer

class Post(Base):
    __tablename__ = "posts"
    
    id = Column(Integer, primary_key=True)
    title = Column(String(255))
    content = Column(String)</code></pre>
                </div>

                <div class="bg-gray-50 rounded-xl p-6">
                    <h3 class="font-bold mb-3">Query Data</h3>
                    <pre class="bg-gray-900 text-green-400 p-4 rounded-lg overflow-x-auto text-sm"><code>from nextpy.db import Session
from models.post import Post

async def get_server_side_props(context):
    with Session() as session:
        posts = session.query(Post).all()
        return {"props": {"posts": posts}}</code></pre>
                </div>
            </section>

            <!-- Authentication -->
            <section id="authentication">
                <h2 class="text-3xl font-bold mb-6 text-gray-900 pb-4 border-b-2 border-blue-200">Authentication</h2>
                
                <p class="text-gray-700 mb-6">Built-in JWT authentication for secure API endpoints.</p>

                <pre class="bg-gray-900 text-green-400 p-4 rounded-lg overflow-x-auto text-sm mb-6"><code>from nextpy.auth import AuthManager

# Create token
token = AuthManager.create_token(user_id=123)

# Verify token  
user_id = AuthManager.verify_token(token)</code></pre>

                <p class="text-gray-600 p-4 bg-blue-50 rounded-lg">
                    üìñ See <strong>AUTHENTICATION.md</strong> for complete guide with login examples
                </p>
            </section>

            <!-- Components -->
            <section id="components">
                <h2 class="text-3xl font-bold mb-6 text-gray-900 pb-4 border-b-2 border-blue-200">Components & Templates</h2>
                
                <div class="bg-gray-50 rounded-xl p-6 mb-6">
                    <h3 class="font-bold mb-3">Use Built-in Components</h3>
                    <pre class="bg-gray-900 text-green-400 p-4 rounded-lg overflow-x-auto text-sm"><code>{% raw %}{% from 'components/button.html' import button %}
{{ button('Click me', href='/page', variant='primary') }}

{% from 'components/card.html' import card %}
{{ card(title='Title', content='Content') }}{% endraw %}</code></pre>
                </div>

                <div class="bg-gray-50 rounded-xl p-6">
                    <h3 class="font-bold mb-3">Create Custom Components</h3>
                    <pre class="bg-gray-900 text-green-400 p-4 rounded-lg overflow-x-auto text-sm"><code>{% raw %}{% macro custom_card(title) %}
<div class="card">
    <h3>{{ title }}</h3>
    {{ caller() }}
</div>
{% endmacro %}{% endraw %}</code></pre>
                </div>
            </section>

            <!-- Utilities -->
            <section id="utilities">
                <h2 class="text-3xl font-bold mb-6 text-gray-900 pb-4 border-b-2 border-blue-200">Built-in Utilities</h2>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-white border border-gray-200 rounded-lg p-6">
                        <h3 class="font-bold text-gray-900 mb-3">üíæ Caching</h3>
                        <pre class="bg-gray-100 text-gray-900 p-3 rounded text-xs overflow-x-auto"><code>from nextpy.utils.cache import cached

@cached(ttl=3600)
async def fetch_data():
    return await db.get_data()</code></pre>
                    </div>
                    
                    <div class="bg-white border border-gray-200 rounded-lg p-6">
                        <h3 class="font-bold text-gray-900 mb-3">üìß Email</h3>
                        <pre class="bg-gray-100 text-gray-900 p-3 rounded text-xs overflow-x-auto"><code>from nextpy.utils.email import send_email

await send_email(
    to="user@example.com",
    subject="Hello",
    html="<p>Welcome</p>"
)</code></pre>
                    </div>
                    
                    <div class="bg-white border border-gray-200 rounded-lg p-6">
                        <h3 class="font-bold text-gray-900 mb-3">üìÅ File Uploads</h3>
                        <pre class="bg-gray-100 text-gray-900 p-3 rounded text-xs overflow-x-auto"><code>from nextpy.utils.uploads import handle_upload

file_name = await handle_upload(
    file,
    upload_dir="public/uploads"
)</code></pre>
                    </div>
                    
                    <div class="bg-white border border-gray-200 rounded-lg p-6">
                        <h3 class="font-bold text-gray-900 mb-3">üîç Search</h3>
                        <pre class="bg-gray-100 text-gray-900 p-3 rounded text-xs overflow-x-auto"><code>from nextpy.utils.search import FuzzySearch

search = FuzzySearch(data)
results = search.search("query")</code></pre>
                    </div>
                </div>
            </section>

            <!-- Deployment -->
            <section id="deployment">
                <h2 class="text-3xl font-bold mb-6 text-gray-900 pb-4 border-b-2 border-blue-200">Deployment</h2>
                
                <div class="bg-gray-50 rounded-xl p-6 mb-6">
                    <h3 class="text-xl font-bold text-gray-900 mb-3">Build for Production</h3>
                    <pre class="bg-gray-900 text-green-400 p-4 rounded-lg overflow-x-auto text-sm"><code>$ nextpy build
# Creates optimized static files in out/</code></pre>
                </div>

                <div class="bg-gray-50 rounded-xl p-6">
                    <h3 class="text-xl font-bold text-gray-900 mb-3">Environment Variables</h3>
                    <pre class="bg-gray-900 text-green-400 p-4 rounded-lg overflow-x-auto text-sm"><code>DATABASE_URL=postgresql://user:pass@host/db
DEBUG=False
SECRET_KEY=your-secret-key</code></pre>
                </div>
            </section>

            <!-- Troubleshooting -->
            <section id="troubleshooting">
                <h2 class="text-3xl font-bold mb-6 text-gray-900 pb-4 border-b-2 border-blue-200">Troubleshooting</h2>
                
                <div class="space-y-4">
                    <div class="bg-red-50 border-l-4 border-red-600 rounded-lg p-6">
                        <h3 class="font-bold text-gray-900 mb-2">Hot Reload Not Working</h3>
                        <p class="text-sm text-gray-700">Check if watchdog is installed: <code class="bg-red-100 px-2 py-1 rounded">pip install watchdog</code></p>
                    </div>
                    
                    <div class="bg-red-50 border-l-4 border-red-600 rounded-lg p-6">
                        <h3 class="font-bold text-gray-900 mb-2">Database Connection Error</h3>
                        <p class="text-sm text-gray-700">Verify DATABASE_URL in .env and database server is running</p>
                    </div>
                    
                    <div class="bg-red-50 border-l-4 border-red-600 rounded-lg p-6">
                        <h3 class="font-bold text-gray-900 mb-2">Template Not Found</h3>
                        <p class="text-sm text-gray-700">Check template filename in get_template() and file exists in templates/</p>
                    </div>
                </div>
            </section>

            <!-- Best Practices -->
            <section id="best-practices">
                <h2 class="text-3xl font-bold mb-6 text-gray-900 pb-4 border-b-2 border-blue-200">Best Practices</h2>
                
                <ul class="space-y-3 text-gray-700">
                    <li class="flex gap-3">
                        <span class="text-green-600 font-bold">‚úì</span>
                        <span><strong>Use SSG for static content</strong> - Improves performance significantly</span>
                    </li>
                    <li class="flex gap-3">
                        <span class="text-green-600 font-bold">‚úì</span>
                        <span><strong>Cache expensive operations</strong> - Use @cached decorator</span>
                    </li>
                    <li class="flex gap-3">
                        <span class="text-green-600 font-bold">‚úì</span>
                        <span><strong>Validate all inputs</strong> - Use Pydantic models in APIs</span>
                    </li>
                    <li class="flex gap-3">
                        <span class="text-green-600 font-bold">‚úì</span>
                        <span><strong>Use environment variables</strong> - Never hardcode secrets</span>
                    </li>
                    <li class="flex gap-3">
                        <span class="text-green-600 font-bold">‚úì</span>
                        <span><strong>Create reusable components</strong> - Follow DRY principle</span>
                    </li>
                </ul>
            </section>

            <!-- Next Steps -->
            <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-12 border-2 border-blue-200 mt-16">
                <h2 class="text-3xl font-bold mb-6">Ready to Build?</h2>
                <div class="grid md:grid-cols-2 gap-6">
                    <a href="/examples" class="group">
                        <div class="bg-white p-6 rounded-xl hover:shadow-lg transition">
                            <div class="text-4xl mb-4">üé®</div>
                            <h3 class="font-bold text-gray-900">Components</h3>
                            <p class="text-sm text-gray-600">Explore 20+ pre-built UI components</p>
                        </div>
                    </a>
                    
                    <a href="/blog" class="group">
                        <div class="bg-white p-6 rounded-xl hover:shadow-lg transition">
                            <div class="text-4xl mb-4">üìö</div>
                            <h3 class="font-bold text-gray-900">Blog</h3>
                            <p class="text-sm text-gray-600">Tutorials and best practices</p>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
